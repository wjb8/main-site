"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8819],{28819:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var i=n(37876),r=n(77232),a=n(14232),o=n(68667),s=n(81855),c=n(55295),l=n(16361),u=n(60109),d=n(84906);let f=({containerRef:e,id:t,setLoading:n,loading:i})=>{let{closeWithTransition:f,processes:{[t]:m}={}}=(0,s.N)(),{componentWindow:h,defaultSize:y={height:0,width:0},libs:v=[],maximized:b=!1}=m||{},{windowStates:{[t]:g}}=(0,c.w)(),{sizes:{titleBar:p}}=(0,r.DP)(),w=(0,a.useRef)(!1),A=(0,o.A)(),{size:E}=g||{},q=(0,a.useCallback)(e=>{e?.ioq3?.canvas?e.ioq3.canvas.focus(l.VD):requestAnimationFrame(()=>q(e))},[]),k=(0,d.A)(t,e,q,`
      body { display: flex; place-content: center; place-items: center; }
      canvas { background-color: #000; height: 100%; width: 100%; }
      canvas:focus-visible { outline: none; }
    `),[C,x]=(0,a.useState)();(0,a.useEffect)(()=>{if(i){let e=k?.();e&&(0,u.aY)(v,void 0,void 0,void 0,e).then(()=>{if(!e.ioq3)return;e.ioq3.viewport=e.document.body,e.ioq3.elementPointerLock=!0,e.ioq3.callMain([]),e.console.log=e=>{e.startsWith("SDL_Quit called")&&f(t)},n(!1);let i=()=>{e.ioq3?.canvas?(e.ioq3.canvas.addEventListener("contextmenu",u.CH),x(e),A(e.FS,t)):requestAnimationFrame(i)};i()})}},[f,k,t,v,i,A,n]),(0,a.useEffect)(()=>{C?.ioq3&&setTimeout(()=>{if(!C.ioq3?.canvas)return;w.current=b;let{height:e,width:t}=!b&&E||h?.getBoundingClientRect()||{};if(!e||!t)return;let n=y?(0,u.kl)(y.width)/(0,u.kl)(y.height):4/3,i=(0,u.kl)(t),r=i>(0,u.kl)(e)-p.height,a=b&&r?i/n:i,o=a/n;o>0&&a>0&&(C.ioq3.setCanvasSize(a,o),C.ioq3.canvas.setAttribute("style",`object-fit: ${r?"contain":"scale-down"}`))},b||w.current?l.UW.WINDOW+10:0)},[h,C?.ioq3,y,b,E,p.height]),(0,a.useEffect)(()=>()=>{try{C?.ioq3?.exit()}catch{}C?.AL?.contexts.forEach(({ctx:e})=>e.close())},[C?.AL?.contexts,C?.ioq3])};var m=n(35144);let h=({id:e})=>(0,i.jsx)(m.A,{id:e,useHook:f})},35144:(e,t,n)=>{n.d(t,{A:()=>u});var i=n(37876),r=n(14232),a=n(77232),o=n(43010),s=n(78011),c=n(81855);let l=a.Ay.div.withConfig({componentId:"sc-5da8521e-0"})([""]),u=(0,r.memo)(({id:e,useHook:t,StyledComponent:n,children:a})=>{let{processes:{[e]:{url:u=""}={}}}=(0,c.N)(),d=(0,r.useRef)(null),[f,m]=(0,r.useState)(!0),h=(0,r.useMemo)(()=>({contain:"strict",visibility:f?"hidden":"visible"}),[f]);return t({containerRef:d,id:e,loading:f,setLoading:m,url:u}),(0,i.jsxs)(i.Fragment,{children:[f&&(0,i.jsx)(o.A,{}),(0,i.jsx)(n||l,{ref:d,style:h,...(0,s.A)({id:e}),children:a})]})})},43010:(e,t,n)=>{n.d(t,{A:()=>i});let i=n(77232).Ay.div.withConfig({componentId:"sc-29e5eb62-0"})(['cursor:wait;height:100%;width:100%;&::before{color:#fff;content:"Working on it...";display:flex;font-size:12px;justify-content:center;mix-blend-mode:difference;padding-top:18px;}'])},68667:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(14232),r=n(65231);let a=()=>{let{mountEmscriptenFs:e,unMapFs:t,updateFolder:n}=(0,r.f)(),a=(0,i.useRef)("");return(0,i.useEffect)(()=>()=>{if(a.current){let e=a.current;a.current="",t(e,!0).then(()=>n("/",void 0,e)).catch(()=>{})}},[t,n]),(0,i.useCallback)(async(t,i)=>{if(!t)return;let r="";try{r=await e(t,i)}catch{}r&&(n("/",r),a.current=r)},[e,n])}},78011:(e,t,n)=>{n.d(t,{A:()=>h});var i=n(79052),r=n(14232),a=n(49697),o=n(84966),s=n(54188),c=n(65231),l=n(81855),u=n(55295),d=n(16361),f=n(60109),m=n(29804);let h=({callback:e,directory:t=d.Bn,id:n,onDragLeave:h,onDragOver:y,updatePositions:v})=>{let{url:b}=(0,l.N)(),g=(0,m.w)(),{iconPositions:p,sortOrders:w,setIconPositions:A}=(0,u.w)(),{exists:E,mkdirRecursive:q,updateFolder:k,writeFile:C}=(0,c.f)(),x=(0,r.useCallback)(async(e,t,r)=>{if(n)if(t){let a=(0,i.join)(d.Bn,e);if(await q(d.Bn),await C(a,t,!0))return r===s.z.UPDATE_URL&&b(n,a),k(d.Bn,e),(0,i.basename)(a)}else r===s.z.UPDATE_URL&&b(n,e);return""},[n,q,k,b,C]),{openTransferDialog:L}=(0,a.A)();return{onDragLeave:h,onDragOver:(0,r.useCallback)(e=>{y?.(e),(0,f.CH)(e)},[y]),onDrop:(0,r.useCallback)(r=>{if(d.jj.has((0,f.uQ)(t)))return;if(r.target instanceof HTMLElement){if(r.target.closest(".focus-within")?.contains(r.target))return;if(v){let{files:e,text:n}=(0,o.bn)(r);if(0===e.length&&""===n)return;(async()=>{let a={x:r.clientX,y:r.clientY},o=[];if(n){try{o=JSON.parse(n)}catch{}if(!Array.isArray(o))return;let[e]=o;if(!e||e.startsWith(t)&&(0,i.basename)(e)===(0,i.relative)(t,e))return;o=o.map(e=>(0,i.basename)(e))}else o=e instanceof FileList?[...e].map(e=>e.name):[...e].map(e=>e.getAsFile()?.name||"").filter(Boolean);o=await (0,f.$I)(o,t,p,E),(0,f.$Y)(t,r.target,p,w,a,o,A,E)})()}}let a="string"==typeof n;a&&!v&&t===d.Bn&&g.current[n]?.componentWindow?.focus(d.VD),(0,o.nX)(r,e||x,t,L,a)},[e,t,E,p,n,L,g,A,w,v,x])}}},84906:(e,t,n)=>{n.d(t,{A:()=>d});var i=n(14232),r=n(78011),a=n(16361),o=n(81855),s=n(55295);let c=e=>{let t=e.HTMLCanvasElement.prototype.getContext;e.HTMLCanvasElement.prototype.getContext=function(e,n){return("webgl"===e||"webgl2"===e)&&(n=Object.assign(n||{},{preserveDrawingBuffer:!0})),t.call(this,e,n)}},l=e=>{let t=e.createElement("canvas");return t.id="canvas",t.style.width="100%",t.style.height="100%",t.tabIndex=-1,e.body.append(t),t},u=(e,t,n)=>{let i=document.createElement("iframe");i.title=e,i.style.backgroundColor="transparent",i.style.border="0",i.style.width="100%",i.style.height="100%",t.append(i);let r=i.contentDocument;r.open(),r.write(`
    <!DOCTYPE html>
    ${n?`<head><style>${n}</style></head>`:"<head />"}
    <body />
    `),r.close();let a=i.contentWindow;return a.document.documentElement.style.height="100%",a.document.documentElement.style.width="100%",a.document.body.style.height="100%",a.document.body.style.width="100%",a.document.body.style.margin="0",a.document.body.style.overflow="hidden",i},d=(e,t,n,d,f=!1)=>{let[m,h]=(0,i.useState)(),[y,v]=(0,i.useState)(),{onDragOver:b,onDrop:g}=(0,r.A)({id:e}),{processes:{[e]:{maximized:p}={}}={}}=(0,o.N)(),{foregroundId:w,setForegroundId:A}=(0,s.w)(),E=(0,i.useCallback)(()=>{let t;if(!m)return;m.querySelector("iframe")?.remove();let n=u(e,m,d),i=n.contentWindow;c(i),f&&(t=l(n.contentDocument));let r=()=>{f&&t?t.focus(a.VD):i.focus(),A(e)};return i.addEventListener("click",r),i.addEventListener("focus",r),i.addEventListener("blur",()=>A("")),i.addEventListener("dragover",b),i.addEventListener("drop",g),v(i),i},[m,e,b,g,A,d,f]);return(0,i.useLayoutEffect)(()=>{y&&w===e&&requestAnimationFrame(()=>{n?n(y):f?y.document.querySelector("canvas")?.focus(a.VD):y.focus()})},[y,n,w,e,p,f]),(0,i.useEffect)(()=>{if(!m){let e=()=>{requestAnimationFrame(()=>{t.current?h(t.current):e()})};e()}},[m,t]),(0,i.useMemo)(()=>m?E:void 0,[m,E])}}}]);