"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3047,9948],{7567:(e,t,a)=>{a.r(t),a.d(t,{default:()=>s,libs:()=>r,runStableDiffusion:()=>i});var n=a(60109);let r=["/System/tvm/tvmjs_runtime.wasi.js","/System/tvm/tvmjs.bundle.js","/Program Files/StableDiffusion/tokenizers-wasm/tokenizers_wasm.js","/Program Files/StableDiffusion/stable_diffusion.js"],i=async(e,t,a=!1,i=!0)=>{a||(window.tvmjsGlobalEnv=window.tvmjsGlobalEnv||{},await (0,n.aY)(r)),globalThis.tvmjsGlobalEnv.getTokenizer=async()=>(globalThis.tvmjsGlobalEnv.initialized||await globalThis.Tokenizer.init(),globalThis.tvmjsGlobalEnv.initialized=!0,new globalThis.Tokenizer.TokenizerWasm(await (await fetch("/Program Files/StableDiffusion/tokenizers-wasm/tokenizer.json")).text())),i||(globalThis.tvmjsGlobalEnv.canvas=void 0),globalThis.tvmjsGlobalEnv.canvas=globalThis.tvmjsGlobalEnv.canvas||t;let{prompts:s}=e;globalThis.tvmjsGlobalEnv.prompts=s?.length?s:[["A photo of an astronaut riding a elephant on jupiter",""]],await globalThis.tvmjsGlobalEnv.asyncOnGenerate()},s=(e,t={})=>{if(!e)return;let a=document.createElement("canvas");a.height=window.innerHeight,a.width=window.innerWidth,e.append(a),i(t,a)}},26451:(e,t,a)=>{a.d(t,{p:()=>o});var n=a(79052),r=a(14232),i=a(65231),s=a(16361);let o=()=>{let{createPath:e,updateFolder:t}=(0,i.f)();return{createSnapshot:(0,r.useCallback)(async(a,r,i,o=!0,l=s.Sb)=>{let d="";try{if((d=await e(a,l,r,void 0,o))&&i)try{let t="function"==typeof i?await i():i;t&&await e(`${(0,n.join)(l,d)}${s.V9}`,s.jv,t,void 0,o)}catch{}t((0,n.dirname)(l)),t(l,d)}catch{}return d},[e,t])}}},73047:(e,t,a)=>{a.r(t),a.d(t,{default:()=>S});var n=a(37876),r=a(14232),i=a(64148),s=a(16361),o=a(55295),l=a(60109),d=a(26451);let u=(e,t,a)=>{let{contextMenu:n}=(0,i.b)(),{setWallpaper:u}=(0,o.w)(),{createSnapshot:c}=(0,d.p)(),p=(0,r.useCallback)(async a=>e.current?c(`${t}.png`,(0,l.SJ)(e.current),void 0,!1,a):"",[e,c,t]);return(0,r.useMemo)(()=>n?.(()=>[{action:()=>p(s.Bn),disabled:!a,label:"Save to desktop"},{action:()=>p(s.Sb).then(e=>{e&&u(`${s.Sb}/${e}`)}),disabled:!a,label:"Set as background"}]),[n,a,p,u])};var c=a(77232);let p="hsl(270, 100%, 20%)",m="#fff",f="13px",b="512px",v=c.Ay.div.withConfig({componentId:"sc-3d618f5e-0"})(["display:flex;flex-direction:column;place-items:center;nav{display:flex;gap:",";padding:",";width:100%;.prompts{display:flex;flex-direction:column;gap:",";min-width:0;width:100%;textarea{border:1px solid ",";border-radius:",";font-family:",";font-size:12px;padding:",";resize:none;}}button{background:linear-gradient( to bottom right,"," 0%,"," 100% );border:1px solid ",";border-radius:",";color:",";font-size:14px;font-weight:600;padding:10px 15px;&:disabled{background:",";}&:active:not(:disabled){background:",";color:",";}}}.image{display:flex;margin:",";margin-top:0;max-height:",";max-width:",";overflow:auto;place-content:center;place-items:center;position:relative;.status{background-color:",";border:1px solid ",";border-radius:",";box-shadow:rgb(0 0 0 / 20%) 4px 4px 4px;margin:10px;padding:10px;position:absolute;text-align:center;}canvas{background-color:",";border:1px solid ",";border-radius:",";max-height:100%;max-width:100%;}}"],"5px",f,"5px",p,"4px",({theme:e})=>e.formats.systemFont,"5px","hsl(270, 100%, 30%)",p,p,"4px",m,"#ccc",m,p,f,b,b,m,p,"4px",m,p,"4px");var g=a(7567),h=a(91754),x=a(96856);let w=()=>new Worker(a.tu(new URL(a.p+a.u(8535),a.b)),{name:"Stable Diffusion"}),j=["A photo of an astronaut riding a horse on Mars",""],k="No WebGPU Support",S=()=>{let e=(0,r.useRef)(null),[t,a]=(0,r.useState)(j),i=(0,r.useRef)(!1),s=(0,r.useMemo)(()=>"OffscreenCanvas"in window,[]),o=(0,x.A)(w),l=(0,r.useRef)(!1),[d,c]=(0,r.useState)(k),p=(0,r.useCallback)(async()=>{if(e.current){let a={prompts:[t]};if(s&&o.current)if(l.current)o.current.postMessage({config:a});else{let t=e.current.transferControlToOffscreen();l.current=!0,o.current.postMessage({canvas:t,config:a},[t]),o.current.addEventListener("message",({data:e})=>c(e.message))}else window.tvmjsGlobalEnv.logger=c,await (0,g.runStableDiffusion)(a,e.current),c("");i.current=!0}},[t,o,s]),m=(0,h._)(),{onContextMenuCapture:f}=u(e,t[0],i.current&&!d);return(0,r.useEffect)(()=>{m&&d===k&&c("")},[m,d]),(0,n.jsxs)(v,{children:[(0,n.jsxs)("nav",{children:[(0,n.jsxs)("div",{className:"prompts",children:[(0,n.jsx)("textarea",{defaultValue:t[0],onChange:({target:e})=>a(([,t])=>[e.value.trim(),t]),placeholder:"Input Prompt"}),(0,n.jsx)("textarea",{defaultValue:t[1],onChange:({target:e})=>a(([t])=>[t,e.value.trim()]),placeholder:"Negative Prompt"})]}),(0,n.jsx)("button",{disabled:!!d||!m||""===t[0]&&""===t[1],onClick:p,type:"button",children:"Generate"})]}),(0,n.jsxs)("div",{className:"image",children:[(0,n.jsx)("canvas",{ref:e,height:512,onContextMenuCapture:f,width:512}),d&&(0,n.jsx)("div",{className:"status",children:d})]})]})}},91754:(e,t,a)=>{a.d(t,{_:()=>s});var n=a(14232);let r=!1,i=async()=>{let e;if("undefined"==typeof navigator||!("gpu"in navigator))return!1;try{e=await navigator.gpu.requestAdapter()}catch{return!1}if(!e)return!1;let t=0x40000000>(e.limits.maxBufferSize??0)||0x40000000>(e.limits.maxStorageBufferBindingSize??0)||32768>(e.limits.maxComputeWorkgroupStorageSize??0);return t||(r=!0),!t},s=()=>{let[e,t]=(0,n.useState)(r),a=(0,n.useCallback)(async()=>{await i()&&t(!0)},[]);return(0,n.useEffect)(()=>{e||requestAnimationFrame(a)},[a,e]),e}},96856:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(14232);let r=(e,t)=>{let a=(0,n.useRef)(void 0);return(0,n.useEffect)(()=>(e&&!a.current&&(a.current=e(),t&&a.current.addEventListener("message",t,{passive:!0}),a.current.postMessage("init")),()=>{a.current?.terminate(),a.current=void 0}),[t,e]),a}}}]);