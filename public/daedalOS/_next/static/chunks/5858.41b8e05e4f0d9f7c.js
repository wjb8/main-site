"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5858],{35858:(e,t,a)=>{a.r(t),a.d(t,{addFileSystemHandle:()=>d,removeFileSystemHandle:()=>c,requestPermission:()=>l,resetStorage:()=>w});var s=a(79052),r=a(16361),i=a(30690);let n=["/classicube","/data/saves","ejs-bios","ejs-roms","ejs-romsdata","ejs-states","ejs-system","js-dos-cache (emulators-ui-saves)","keyval-store"],o=new Map,d=async(e,t,a,n)=>{if(!await (0,i.Su)())return;let d=await (0,i.Uc)(),c=(0,s.join)(e,a);try{await d.put(i.V0,{...await (0,i.zc)(),[c]:t},r.gq),n&&o.set(c,n)}catch{}},c=async e=>{if(!await (0,i.Su)())return;let{[e]:t,...a}=await (0,i.zc)(),s=await (0,i.Uc)();try{await s.put(i.V0,a,r.gq),o.get(e)?.disconnect(),o.delete(e)}catch{}},l=async e=>{let t=(await (0,i.zc)())[e];if(t){let e=await t.queryPermission();if("prompt"===e)await t.requestPermission();else if("granted"===e)throw Error("Permission already granted");return t.queryPermission()}return!1},w=e=>new Promise((t,s)=>{setTimeout(s,750),window.localStorage.clear(),window.sessionStorage.clear();let r=()=>{let a=e?._getFs("/")?.fs,r=a?.getOverlayedFileSystems(),i=r?.readable,n=r?.writable;i?.empty(),n?.getName()!=="InMemory"&&n?.empty?n.empty(e=>e?s(e):t()):t()};window.indexedDB?a.e(9523,"high").then(a.bind(a,99523)).then(({deleteDB:e})=>{window.indexedDB.databases?window.indexedDB.databases().then(t=>t.filter(({name:e})=>e&&"browserfs"!==e).forEach(({name:t})=>e(t))).then(r).catch(r):(n.forEach(t=>e(t)),r())}):r()})}}]);