"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[818],{30818:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var i=n(37876),r=n(77232);let s=r.Ay.div.withConfig({componentId:"sc-f73b169e-0"})(["height:",";width:100%;"],({theme:e})=>`calc(100% - ${e.sizes.titleBar.height}px)`);var o=n(14232),a=n(68667),l=n(81855),c=n(55295),d=n(16361),u=n(60109),f=n(84906);let h=({containerRef:e,id:t,setLoading:n,loading:i})=>{let{processes:{[t]:s}={}}=(0,l.N)(),h=(0,a.A)(),{windowStates:{[t]:m}}=(0,c.w)(),{size:y}=m||{},{componentWindow:g,libs:p,maximized:v}=s||{},{sizes:{titleBar:w}}=(0,r.DP)(),b=(0,f.A)(t,e,void 0,"canvas { height: 100%; width: 100%; }",!0),[C,E]=(0,o.useState)();(0,o.useEffect)(()=>{setTimeout(()=>{let e=y;if(!e&&g){let{height:t,width:n}=g.getBoundingClientRect();e={height:t,width:n}}e&&(C?.CCModule.setCanvasSize?.((0,u.kl)(e.width),(0,u.kl)(e.height)-w.height),C?.CCModule.OnResize?.())},d.UW.WINDOW)},[g,C?.CCModule,v,y,w.height]),(0,o.useEffect)(()=>{if(i){let e=b?.();if(!e)return;let i=e?.document.querySelector("canvas");i.addEventListener("contextmenu",u.CH),e.CCModule={arguments:["Singleplayer"],canvas:i,postRun:[()=>{n(!1),E(e),h(e.FS,t)},()=>{let{width:e,height:t}=i.getBoundingClientRect()||{};i.width=e,i.height=t}],print:console.info,setStatus:console.info,windowElement:e.document.body},(0,u.aY)(p,void 0,void 0,void 0,e)}},[b,t,p,i,h,n])};var m=n(35144);let y=({id:e})=>(0,i.jsx)(m.A,{StyledComponent:s,id:e,useHook:h})},35144:(e,t,n)=>{n.d(t,{A:()=>d});var i=n(37876),r=n(14232),s=n(77232),o=n(43010),a=n(78011),l=n(81855);let c=s.Ay.div.withConfig({componentId:"sc-5da8521e-0"})([""]),d=(0,r.memo)(({id:e,useHook:t,StyledComponent:n,children:s})=>{let{processes:{[e]:{url:d=""}={}}}=(0,l.N)(),u=(0,r.useRef)(null),[f,h]=(0,r.useState)(!0),m=(0,r.useMemo)(()=>({contain:"strict",visibility:f?"hidden":"visible"}),[f]);return t({containerRef:u,id:e,loading:f,setLoading:h,url:d}),(0,i.jsxs)(i.Fragment,{children:[f&&(0,i.jsx)(o.A,{}),(0,i.jsx)(n||c,{ref:u,style:m,...(0,a.A)({id:e}),children:s})]})})},43010:(e,t,n)=>{n.d(t,{A:()=>i});let i=n(77232).Ay.div.withConfig({componentId:"sc-29e5eb62-0"})(['cursor:wait;height:100%;width:100%;&::before{color:#fff;content:"Working on it...";display:flex;font-size:12px;justify-content:center;mix-blend-mode:difference;padding-top:18px;}'])},68667:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(14232),r=n(65231);let s=()=>{let{mountEmscriptenFs:e,unMapFs:t,updateFolder:n}=(0,r.f)(),s=(0,i.useRef)("");return(0,i.useEffect)(()=>()=>{if(s.current){let e=s.current;s.current="",t(e,!0).then(()=>n("/",void 0,e)).catch(()=>{})}},[t,n]),(0,i.useCallback)(async(t,i)=>{if(!t)return;let r="";try{r=await e(t,i)}catch{}r&&(n("/",r),s.current=r)},[e,n])}},78011:(e,t,n)=>{n.d(t,{A:()=>m});var i=n(79052),r=n(14232),s=n(49697),o=n(84966),a=n(54188),l=n(65231),c=n(81855),d=n(55295),u=n(16361),f=n(60109),h=n(29804);let m=({callback:e,directory:t=u.Bn,id:n,onDragLeave:m,onDragOver:y,updatePositions:g})=>{let{url:p}=(0,c.N)(),v=(0,h.w)(),{iconPositions:w,sortOrders:b,setIconPositions:C}=(0,d.w)(),{exists:E,mkdirRecursive:A,updateFolder:k,writeFile:x}=(0,l.f)(),S=(0,r.useCallback)(async(e,t,r)=>{if(n)if(t){let s=(0,i.join)(u.Bn,e);if(await A(u.Bn),await x(s,t,!0))return r===a.z.UPDATE_URL&&p(n,s),k(u.Bn,e),(0,i.basename)(s)}else r===a.z.UPDATE_URL&&p(n,e);return""},[n,A,k,p,x]),{openTransferDialog:D}=(0,s.A)();return{onDragLeave:m,onDragOver:(0,r.useCallback)(e=>{y?.(e),(0,f.CH)(e)},[y]),onDrop:(0,r.useCallback)(r=>{if(u.jj.has((0,f.uQ)(t)))return;if(r.target instanceof HTMLElement){if(r.target.closest(".focus-within")?.contains(r.target))return;if(g){let{files:e,text:n}=(0,o.bn)(r);if(0===e.length&&""===n)return;(async()=>{let s={x:r.clientX,y:r.clientY},o=[];if(n){try{o=JSON.parse(n)}catch{}if(!Array.isArray(o))return;let[e]=o;if(!e||e.startsWith(t)&&(0,i.basename)(e)===(0,i.relative)(t,e))return;o=o.map(e=>(0,i.basename)(e))}else o=e instanceof FileList?[...e].map(e=>e.name):[...e].map(e=>e.getAsFile()?.name||"").filter(Boolean);o=await (0,f.$I)(o,t,w,E),(0,f.$Y)(t,r.target,w,b,s,o,C,E)})()}}let s="string"==typeof n;s&&!g&&t===u.Bn&&v.current[n]?.componentWindow?.focus(u.VD),(0,o.nX)(r,e||S,t,D,s)},[e,t,E,w,n,D,v,C,b,g,S])}}},84906:(e,t,n)=>{n.d(t,{A:()=>u});var i=n(14232),r=n(78011),s=n(16361),o=n(81855),a=n(55295);let l=e=>{let t=e.HTMLCanvasElement.prototype.getContext;e.HTMLCanvasElement.prototype.getContext=function(e,n){return("webgl"===e||"webgl2"===e)&&(n=Object.assign(n||{},{preserveDrawingBuffer:!0})),t.call(this,e,n)}},c=e=>{let t=e.createElement("canvas");return t.id="canvas",t.style.width="100%",t.style.height="100%",t.tabIndex=-1,e.body.append(t),t},d=(e,t,n)=>{let i=document.createElement("iframe");i.title=e,i.style.backgroundColor="transparent",i.style.border="0",i.style.width="100%",i.style.height="100%",t.append(i);let r=i.contentDocument;r.open(),r.write(`
    <!DOCTYPE html>
    ${n?`<head><style>${n}</style></head>`:"<head />"}
    <body />
    `),r.close();let s=i.contentWindow;return s.document.documentElement.style.height="100%",s.document.documentElement.style.width="100%",s.document.body.style.height="100%",s.document.body.style.width="100%",s.document.body.style.margin="0",s.document.body.style.overflow="hidden",i},u=(e,t,n,u,f=!1)=>{let[h,m]=(0,i.useState)(),[y,g]=(0,i.useState)(),{onDragOver:p,onDrop:v}=(0,r.A)({id:e}),{processes:{[e]:{maximized:w}={}}={}}=(0,o.N)(),{foregroundId:b,setForegroundId:C}=(0,a.w)(),E=(0,i.useCallback)(()=>{let t;if(!h)return;h.querySelector("iframe")?.remove();let n=d(e,h,u),i=n.contentWindow;l(i),f&&(t=c(n.contentDocument));let r=()=>{f&&t?t.focus(s.VD):i.focus(),C(e)};return i.addEventListener("click",r),i.addEventListener("focus",r),i.addEventListener("blur",()=>C("")),i.addEventListener("dragover",p),i.addEventListener("drop",v),g(i),i},[h,e,p,v,C,u,f]);return(0,i.useLayoutEffect)(()=>{y&&b===e&&requestAnimationFrame(()=>{n?n(y):f?y.document.querySelector("canvas")?.focus(s.VD):y.focus()})},[y,n,b,e,w,f]),(0,i.useEffect)(()=>{if(!h){let e=()=>{requestAnimationFrame(()=>{t.current?m(t.current):e()})};e()}},[h,t]),(0,i.useMemo)(()=>h?E:void 0,[h,E])}}}]);